<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEO-PROJECT - Link Generator</title>
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Material Design Lite -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    
    <!-- QR Code -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <style>
        :root {
            --primary-color: #3f51b5;
            --primary-dark: #303f9f;
            --primary-light: #c5cae9;
            --accent-color: #ff4081;
            --text-primary: #212121;
            --text-secondary: #757575;
            --divider-color: #bdbdbd;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1a237e, #3949ab, #5c6bc0);
            min-height: 100vh;
            margin: 0;
            color: var(--text-primary);
        }
        
        .main-container {
            max-width: 480px;
            margin: 0 auto;
            padding: 16px;
        }
        
        .geo-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 16px;
            overflow: hidden;
        }
        
        .geo-header {
            background: var(--primary-color);
            color: white;
            padding: 16px;
            text-align: center;
        }
        
        .geo-title {
            font-size: 24px;
            font-weight: 500;
            margin: 0;
        }
        
        .geo-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin: 4px 0 0;
        }
        
        .geo-nav {
            display: flex;
            justify-content: center;
            background: var(--primary-light);
            padding: 8px;
            flex-wrap: wrap;
        }
        
        .geo-nav-item {
            padding: 8px 16px;
            margin: 4px;
            border-radius: 16px;
            color: var(--primary-dark);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .geo-nav-item:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .geo-nav-item.active {
            background: white;
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .geo-content {
            padding: 16px;
        }
        
        .geo-search {
            position: relative;
            margin-bottom: 16px;
        }
        
        .geo-search input {
            width: 100%;
            padding: 12px 16px 12px 48px;
            border: 1px solid var(--divider-color);
            border-radius: 24px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .geo-search .material-icons {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }
        
        .geo-proxy-card {
            background: #f5f5f5;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .geo-proxy-card:hover {
            background: #eeeeee;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .geo-proxy-info {
            flex: 1;
            min-width: 0;
        }
        
        .geo-proxy-name {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .geo-proxy-details {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .geo-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .geo-status.active {
            background: #4caf50;
        }
        
        .geo-status.dead {
            background: #f44336;
        }
        
        .geo-status.unknown {
            background: #ff9800;
        }
        
        .geo-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .geo-btn:hover {
            background: var(--primary-dark);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .geo-btn-secondary {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        
        .geo-btn-secondary:hover {
            background: rgba(63, 81, 181, 0.1);
        }
        
        .geo-tabs {
            display: flex;
            border-bottom: 1px solid var(--divider-color);
            margin-bottom: 16px;
        }
        
        .geo-tab {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .geo-tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .geo-form-group {
            margin-bottom: 16px;
        }
        
        .geo-form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-primary);
        }
        
        .geo-form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--divider-color);
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .geo-form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .geo-form-control[readonly] {
            background: #f5f5f5;
        }
        
        .geo-select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--divider-color);
            border-radius: 4px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }
        
        .geo-result-card {
            background: #f5f5f5;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .geo-result-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 12px;
            color: var(--primary-color);
        }
        
        .geo-result-url {
            background: white;
            border: 1px solid var(--divider-color);
            border-radius: 4px;
            padding: 12px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            margin-bottom: 12px;
        }
        
        .geo-qrcode {
            display: flex;
            justify-content: center;
            padding: 16px;
            background: white;
            border-radius: 4px;
        }
        
        .geo-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 16px 0;
        }
        
        .geo-pagination button {
            background: white;
            border: 1px solid var(--divider-color);
            border-radius: 4px;
            padding: 8px 12px;
            margin: 0 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .geo-pagination button:hover {
            background: var(--primary-light);
        }
        
        .geo-pagination button.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .geo-pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .geo-loading {
            text-align: center;
            padding: 32px;
        }
        
        .geo-loading .material-icons {
            font-size: 48px;
            color: var(--primary-color);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .geo-footer {
            text-align: center;
            padding: 16px;
            color: white;
            font-size: 14px;
        }
        
        .geo-donate-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent-color);
            color: white;
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
        }
        
        .geo-donate-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .geo-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .geo-modal-content {
            background: white;
            border-radius: 8px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            position: relative;
        }
        
        .geo-modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        
        @media (max-width: 480px) {
            .main-container {
                padding: 8px;
            }
            
            .geo-nav-item {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .geo-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="geo-card">
            <div class="geo-header">
                <h1 class="geo-title">GEO-PROJECT</h1>
                <p class="geo-subtitle">Advanced Link Generator</p>
            </div>
            
            <nav class="geo-nav">
                <a href="/" class="geo-nav-item">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">home</i>
                    Home
                </a>
                <a href="sub" class="geo-nav-item">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">rss_feed</i>
                    Subscription
                </a>
                <a href="link" class="geo-nav-item active">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">link</i>
                    Link Generator
                </a>
                <a href="converter" class="geo-nav-item">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">swap_horiz</i>
                    Converter
                </a>
                <a href="checker" class="geo-nav-item">
                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">cloud</i>
                    IP Checker
                </a>
            </nav>
            
            <div class="geo-content">
                <!-- Proxy List Section -->
                <div id="proxy-list-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h2 style="font-size: 18px; font-weight: 500; margin: 0;">
                            <i class="material-icons" style="font-size: 18px; vertical-align: middle; margin-right: 8px;">dns</i>
                            Proxy List
                        </h2>
                        <div style="display: flex; gap: 8px;">
                            <button id="refresh-btn" class="geo-btn">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">refresh</i>
                                Refresh
                            </button>
                            <button id="custom-url-btn" class="geo-btn geo-btn-secondary">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">link</i>
                                URL
                            </button>
                        </div>
                    </div>
                    
                    <div id="custom-url-input" style="display: none; margin-bottom: 16px;">
                        <div style="display: flex; gap: 8px;">
                            <input type="text" id="proxy-url" class="geo-form-control" placeholder="Enter custom proxy list URL" 
                                value="https://raw.githubusercontent.com/paoandest/botak/refs/heads/main/cek/proxyList.txt">
                            <button id="load-custom-url" class="geo-btn">Load</button>
                        </div>
                    </div>
                    
                    <div id="loading-indicator" class="geo-loading" style="display: none;">
                        <i class="material-icons">refresh</i>
                        <p>Loading proxy list...</p>
                    </div>
                    
                    <div class="geo-search">
                        <i class="material-icons">search</i>
                        <input type="text" id="search-input" placeholder="Search by provider or country...">
                    </div>
                    
                    <div id="proxy-list-container">
                        <!-- Proxy cards will be populated here -->
                    </div>
                    
                    <div id="pagination-container" class="geo-pagination">
                        <!-- Pagination buttons will be added here -->
                    </div>
                    
                    <div id="proxy-count-info" style="text-align: center; font-size: 12px; color: var(--text-secondary); margin-top: 8px;">
                        <!-- Proxy count will be shown here -->
                    </div>
                    
                    <div id="no-proxies-message" style="display: none; text-align: center; padding: 32px;">
                        <i class="material-icons" style="font-size: 48px; color: #f44336;">error</i>
                        <p>No proxies found. Please refresh or try a different URL.</p>
                    </div>
                </div>
                
                <!-- Account Creation Section -->
                <div id="account-creation-section" style="display: none;">
                    <div style="border-bottom: 1px solid var(--divider-color); margin-bottom: 16px; padding-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 style="font-size: 18px; font-weight: 500; margin: 0;">
                                <i class="material-icons" style="font-size: 18px; vertical-align: middle; margin-right: 8px;">person_add</i>
                                Create Account
                            </h2>
                            <button id="back-to-list" class="geo-btn geo-btn-secondary">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">arrow_back</i>
                                Back to List
                            </button>
                        </div>
                    </div>
                    
                    <div class="geo-result-card">
                        <h3 style="font-size: 16px; font-weight: 500; margin: 0 0 12px 0; color: var(--primary-color);">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 8px;">dns</i>
                            Selected Proxy
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                            <div style="background: white; border-radius: 4px; padding: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Provider</div>
                                <div id="selected-provider" style="font-weight: 500;">-</div>
                            </div>
                            <div style="background: white; border-radius: 4px; padding: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Country</div>
                                <div id="selected-country" style="font-weight: 500;">-</div>
                            </div>
                            <div style="background: white; border-radius: 4px; padding: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">IP</div>
                                <div id="selected-ip" style="font-weight: 500;">-</div>
                            </div>
                            <div style="background: white; border-radius: 4px; padding: 12px;">
                                <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Port</div>
                                <div id="selected-port" style="font-weight: 500;">-</div>
                            </div>
                        </div>
                        
                        <div id="proxy-status-container" style="display: none;">
                            <div id="proxy-status-active" style="display: none; background: #e8f5e9; border-radius: 4px; padding: 12px; margin-bottom: 8px;">
                                <div style="display: flex; align-items: center;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #4caf50; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                        <i class="material-icons" style="font-size: 16px; color: white;">check</i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 500; color: #2e7d32;">ACTIVE</div>
                                        <div style="font-size: 12px; color: var(--text-secondary);">Latency: <span id="proxy-latency" style="color: #ff9800;">0ms</span></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="proxy-status-dead" style="display: none; background: #ffebee; border-radius: 4px; padding: 12px; margin-bottom: 8px;">
                                <div style="display: flex; align-items: center;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #f44336; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                        <i class="material-icons" style="font-size: 16px; color: white;">close</i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 500; color: #c62828;">DEAD</div>
                                        <div style="font-size: 12px; color: var(--text-secondary);">This proxy may not be working</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="proxy-status-unknown" style="display: none; background: #fff3e0; border-radius: 4px; padding: 12px; margin-bottom: 8px;">
                                <div style="display: flex; align-items: center;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #ff9800; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                        <i class="material-icons" style="font-size: 16px; color: white;">help</i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 500; color: #ef6c00;">UNKNOWN</div>
                                        <div style="font-size: 12px; color: var(--text-secondary);">Could not check proxy status</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="proxy-status-loading" style="background: #e3f2fd; border-radius: 4px; padding: 12px; margin-bottom: 8px;">
                                <div style="display: flex; align-items: center;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #2196f3; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                                        <div class="geo-loading" style="padding: 0; margin: 0;">
                                            <i class="material-icons" style="font-size: 16px;">refresh</i>
                                        </div>
                                    </div>
                                    <div>
                                        <div style="font-weight: 500; color: #1565c0;">CHECKING</div>
                                        <div style="font-size: 12px; color: var(--text-secondary);">Verifying proxy status...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabs -->
                    <div class="geo-tabs">
                        <div class="geo-tab active" data-target="vmess-form">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">security</i>
                            VMess
                        </div>
                        <div class="geo-tab" data-target="vless-form">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">bolt</i>
                            VLESS
                        </div>
                        <div class="geo-tab" data-target="trojan-form">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">person</i>
                            Trojan
                        </div>
                        <div class="geo-tab" data-target="ss-form">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">mask</i>
                            SS
                        </div>
                    </div>
                    
                    <!-- VMess Form -->
                    <div id="vmess-form" class="protocol-form">
                        <form id="vmess-account-form">
                            <div class="geo-form-group">
                                <label for="vmess-name">Account Name</label>
                                <input type="text" id="vmess-name" name="name" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vmess-uuid">UUID</label>
                                <input type="text" id="vmess-uuid" name="uuid" class="geo-form-control" value="f282b878-8711-45a1-8c69-5564172123c1" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vmess-path">Path</label>
                                <input type="text" id="vmess-path" name="path" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vmess-security">TLS</label>
                                <select id="vmess-security" name="security" class="geo-select">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                                <input type="hidden" id="vmess-encryption" name="encryption" value="zero">
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vmess-server-domain">Server Domain</label>
                                <select id="vmess-server-domain" name="server-domain" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vmess-bug">Custom Bug (optional)</label>
                                <select id="vmess-bug" name="bug" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                                <div id="vmess-manual-bug-container" style="display: none; margin-top: 8px;">
                                    <input type="text" id="vmess-manual-bug" class="geo-form-control" placeholder="Enter custom bug domain">
                                </div>
                                <div id="vmess-wildcard-container" style="display: none; margin-top: 8px;">
                                    <label style="display: flex; align-items: center; font-size: 14px;">
                                        <input type="checkbox" id="vmess-wildcard" name="wildcard" style="margin-right: 8px;">
                                        Use Wildcard (bug.domain.com)
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-top: 16px;">
                                <button type="submit" class="geo-btn" style="width: 100%;">
                                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">add_circle</i>
                                    Create VMess Account
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- VLESS Form -->
                    <div id="vless-form" class="protocol-form" style="display: none;">
                        <form id="vless-account-form">
                            <div class="geo-form-group">
                                <label for="vless-name">Account Name</label>
                                <input type="text" id="vless-name" name="name" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vless-uuid">UUID</label>
                                <div style="display: flex;">
                                    <input type="text" id="vless-uuid" name="uuid" class="geo-form-control" style="flex: 1; border-radius: 4px 0 0 4px;" value="f282b878-8711-45a1-8c69-5564172123c1" required>
                                    <button type="button" onclick="generateUUID('vless-uuid')" class="geo-btn geo-btn-secondary" style="border-radius: 0 4px 4px 0;">
                                        <i class="material-icons" style="font-size: 16px;">refresh</i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vless-path">Path</label>
                                <input type="text" id="vless-path" name="path" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vless-security">TLS</label>
                                <select id="vless-security" name="security" class="geo-select">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                                <input type="hidden" id="vless-encryption" name="encryption" value="none">
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vless-server-domain">Server Domain</label>
                                <select id="vless-server-domain" name="server-domain" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="vless-bug">Custom Bug (optional)</label>
                                <select id="vless-bug" name="bug" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                                <div id="vless-manual-bug-container" style="display: none; margin-top: 8px;">
                                    <input type="text" id="vless-manual-bug" class="geo-form-control" placeholder="Enter custom bug domain">
                                </div>
                                <div id="vless-wildcard-container" style="display: none; margin-top: 8px;">
                                    <label style="display: flex; align-items: center; font-size: 14px;">
                                        <input type="checkbox" id="vless-wildcard" name="wildcard" style="margin-right: 8px;">
                                        Use Wildcard (bug.domain.com)
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-top: 16px;">
                                <button type="submit" class="geo-btn" style="width: 100%;">
                                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">add_circle</i>
                                    Create VLESS Account
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Trojan Form -->
                    <div id="trojan-form" class="protocol-form" style="display: none;">
                        <form id="trojan-account-form">
                            <div class="geo-form-group">
                                <label for="trojan-name">Account Name</label>
                                <input type="text" id="trojan-name" name="name" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="trojan-password">Password</label>
                                <div style="display: flex;">
                                    <input type="text" id="trojan-password" name="password" class="geo-form-control" style="flex: 1; border-radius: 4px 0 0 4px;" value="f282b878-8711-45a1-8c69-5564172123c1" required>
                                    <button type="button" onclick="generatePassword('trojan-password')" class="geo-btn geo-btn-secondary" style="border-radius: 0 4px 4px 0;">
                                        <i class="material-icons" style="font-size: 16px;">refresh</i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="trojan-path">Path</label>
                                <input type="text" id="trojan-path" name="path" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="trojan-security">TLS</label>
                                <select id="trojan-security" name="security" class="geo-select">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                                <input type="hidden" id="trojan-sni" name="sni" value="vm.gpj.web.id">
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="trojan-server-domain">Server Domain</label>
                                <select id="trojan-server-domain" name="server-domain" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="trojan-bug">Custom Bug (optional)</label>
                                <select id="trojan-bug" name="bug" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                                <div id="trojan-manual-bug-container" style="display: none; margin-top: 8px;">
                                    <input type="text" id="trojan-manual-bug" class="geo-form-control" placeholder="Enter custom bug domain">
                                </div>
                                <div id="trojan-wildcard-container" style="display: none; margin-top: 8px;">
                                    <label style="display: flex; align-items: center; font-size: 14px;">
                                        <input type="checkbox" id="trojan-wildcard" name="wildcard" style="margin-right: 8px;">
                                        Use Wildcard (bug.domain.com)
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-top: 16px;">
                                <button type="submit" class="geo-btn" style="width: 100%;">
                                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">add_circle</i>
                                    Create Trojan Account
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Shadowsocks Form -->
                    <div id="ss-form" class="protocol-form" style="display: none;">
                        <form id="ss-account-form">
                            <div class="geo-form-group">
                                <label for="ss-name">Account Name</label>
                                <input type="text" id="ss-name" name="name" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="ss-password">Password</label>
                                <div style="display: flex;">
                                    <input type="text" id="ss-password" name="password" class="geo-form-control" style="flex: 1; border-radius: 4px 0 0 4px;" value="f282b878-8711-45a1-8c69-5564172123c1" required>
                                    <button type="button" onclick="generatePassword('ss-password')" class="geo-btn geo-btn-secondary" style="border-radius: 0 4px 4px 0;">
                                        <i class="material-icons" style="font-size: 16px;">refresh</i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="ss-path">Path</label>
                                <input type="text" id="ss-path" name="path" class="geo-form-control" readonly>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="ss-security">TLS</label>
                                <select id="ss-security" name="security" class="geo-select">
                                    <option value="tls">TLS</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="ss-server-domain">Server Domain</label>
                                <select id="ss-server-domain" name="server-domain" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                            </div>
                            
                            <div class="geo-form-group">
                                <label for="ss-bug">Custom Bug (optional)</label>
                                <select id="ss-bug" name="bug" class="geo-select">
                                    <!-- Options will be populated dynamically -->
                                </select>
                                <div id="ss-manual-bug-container" style="display: none; margin-top: 8px;">
                                    <input type="text" id="ss-manual-bug" class="geo-form-control" placeholder="Enter custom bug domain">
                                </div>
                                <div id="ss-wildcard-container" style="display: none; margin-top: 8px;">
                                    <label style="display: flex; align-items: center; font-size: 14px;">
                                        <input type="checkbox" id="ss-wildcard" name="wildcard" style="margin-right: 8px;">
                                        Use Wildcard (bug.domain.com)
                                    </label>
                                </div>
                            </div>
                            
                            <div style="margin-top: 16px;">
                                <button type="submit" class="geo-btn" style="width: 100%;">
                                    <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">add_circle</i>
                                    Create Shadowsocks Account
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Result Section -->
                <div id="result-section" style="display: none;">
                    <div style="border-bottom: 1px solid var(--divider-color); margin-bottom: 16px; padding-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 style="font-size: 18px; font-weight: 500; margin: 0;">
                                <i class="material-icons" style="font-size: 18px; vertical-align: middle; margin-right: 8px;">check_circle</i>
                                Account Created
                            </h2>
                            <button id="back-to-form" class="geo-btn geo-btn-secondary">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">arrow_back</i>
                                Back
                            </button>
                        </div>
                    </div>
                    
                    <div class="geo-result-card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h3 style="font-size: 16px; font-weight: 500; margin: 0; color: var(--primary-color);">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 8px;">link</i>
                                Connection URL
                            </h3>
                            <button id="copy-url" class="geo-btn geo-btn-secondary">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">content_copy</i>
                                Copy
                            </button>
                        </div>
                        <div id="connection-url" class="geo-result-url"></div>
                    </div>
                    
                    <div class="geo-result-card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h3 style="font-size: 16px; font-weight: 500; margin: 0; color: var(--primary-color);">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 8px;">qr_code</i>
                                QR Code
                            </h3>
                            <button id="download-qr" class="geo-btn geo-btn-secondary">
                                <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">download</i>
                                Download
                            </button>
                        </div>
                        <div class="geo-qrcode">
                            <div id="qrcode"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 8px; margin-top: 16px;">
                        <button id="create-new" class="geo-btn" style="flex: 1;">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">add_circle</i>
                            Create Another
                        </button>
                        <button id="back-to-list-from-result" class="geo-btn geo-btn-secondary" style="flex: 1;">
                            <i class="material-icons" style="font-size: 16px; vertical-align: middle; margin-right: 4px;">list</i>
                            Back to List
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="geo-footer">
            <div style="font-weight: 500; margin-bottom: 4px;">GEO-PROJECT</div>
            <div style="font-size: 12px; opacity: 0.8;">POWERED BY SECURE TECHNOLOGY</div>
        </div>
    </div>
    
    <button id="donation-button" class="geo-donate-btn">
        <i class="material-icons">favorite</i>
    </button>
    
    <!-- Donation Modal -->
    <div id="donation-modal" class="geo-modal">
        <div class="geo-modal-content">
            <button id="close-donation" class="geo-modal-close">
                <i class="material-icons">close</i>
            </button>
            
            <h2 style="margin-top: 0; text-align: center; color: var(--primary-color);">Support Geo-Project</h2>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 24px;">Your donation helps keep our services running</p>
            
            <div style="text-align: center; margin-bottom: 16px;">
                <img src="https://raw.githubusercontent.com/jaka2m/vpn-cf/refs/heads/master/web/qris.png" alt="Donation QR Code" style="max-width: 200px; border-radius: 8px;">
            </div>
            
            <p style="text-align: center; font-size: 12px; color: var(--text-secondary);">Scan this QR code with your payment app to donate</p>
        </div>
    </div>
    
    <script>
        // Global variables
        let proxyList = [];
        let filteredProxyList = [];
        let selectedProxy = null;
        const serverDomains = ['vm.gpj.web.id', 'vpn.checker-ip.web.id'];
        let selectedServerDomain = serverDomains[0];
        let currentPage = 1;
        const bugOptions = [
            { value: '', label: 'Default' },
            { value: 'cache.netflix.com', label: 'cache.netflix.com' },
            { value: 'ava.game.naver.com', label: 'ava.game.naver.com' },
            { value: 'graph.instagram.com', label: 'graph.instagram.com' },
            { value: 'support.zoom.us', label: 'support.zoom.us' },
            { value: 'zaintest.vuclip.com', label: 'help.viu.com' },
            { value: 'manual', label: 'Type Manual' }
        ];
        
        // DOM elements
        const proxyListSection = document.getElementById("proxy-list-section");
        const accountCreationSection = document.getElementById("account-creation-section");
        const resultSection = document.getElementById('result-section');
        const loadingIndicator = document.getElementById("loading-indicator");
        const proxyListContainer = document.getElementById("proxy-list-container");
        const noProxiesMessage = document.getElementById("no-proxies-message");
        const customUrlInput = document.getElementById('custom-url-input');
        const proxyUrlInput = document.getElementById("proxy-url");
        const paginationContainer = document.getElementById('pagination-container');
        const proxyCountInfo = document.getElementById("proxy-count-info");
        const searchInput = document.getElementById("search-input");
        
        // Initialize
        document.addEventListener("DOMContentLoaded", () => {
            displayFallbackProxyList();
            loadProxyList("https://raw.githubusercontent.com/paoandest/botak/refs/heads/main/cek/proxyList.txt");
            setupEventListeners();
            populateBugOptions();
            populateServerDomains();
        });
        
        // Setup event listeners
        function setupEventListeners() {
            // Navigation buttons
            document.getElementById("refresh-btn").addEventListener("click", () => {
                loadProxyList("https://raw.githubusercontent.com/paoandest/botak/refs/heads/main/cek/proxyList.txt");
            });
            
            document.getElementById("custom-url-btn").addEventListener("click", () => {
                customUrlInput.classList.toggle('hidden');
            });
            
            document.getElementById("load-custom-url").addEventListener("click", () => {
                const customUrl = proxyUrlInput.value.trim();
                if (customUrl) {
                    loadProxyList(customUrl);
                }
            });
            
            // Back buttons
            document.getElementById("back-to-list").addEventListener('click', () => {
                showProxyListSection();
            });
            
            document.getElementById("back-to-form").addEventListener("click", () => {
                resultSection.classList.add("hidden");
                accountCreationSection.classList.remove("hidden");
            });
            
            document.getElementById("create-new").addEventListener('click', () => {
                resultSection.classList.add("hidden");
                accountCreationSection.classList.remove("hidden");
            });
            
            document.getElementById("back-to-list-from-result").addEventListener("click", () => {
                showProxyListSection();
            });
            
            // Search
            searchInput.addEventListener("input", function () {
                const searchQuery = this.value.toLowerCase().trim();
                if (searchQuery === '') {
                    filteredProxyList = [...proxyList];
                } else {
                    filteredProxyList = proxyList.filter(proxy => 
                        proxy.provider.toLowerCase().includes(searchQuery) || 
                        proxy.country.toLowerCase().includes(searchQuery)
                    );
                }
                currentPage = 1;
                renderProxyList();
            });
            
            // Tabs
            document.querySelectorAll(".geo-tab").forEach(button => {
                button.addEventListener("click", () => {
                    document.querySelectorAll(".geo-tab").forEach(tab => {
                        tab.classList.remove("active");
                    });
                    button.classList.add("active");
                    
                    document.querySelectorAll(".protocol-form").forEach(form => {
                        form.classList.add('hidden');
                    });
                    
                    const targetId = button.getAttribute("data-target");
                    document.getElementById(targetId).classList.remove("hidden");
                });
            });
            
            // Forms
            const forms = ['vmess', 'vless', 'trojan', 'ss'];
            forms.forEach(protocol => {
                const form = document.getElementById(`${protocol}-account-form`);
                if (form) {
                    form.addEventListener("submit", (e) => {
                        e.preventDefault();
                        handleFormSubmit(protocol, new FormData(form));
                    });
                }
            });
            
            // Copy URL
            document.getElementById("copy-url").addEventListener("click", function () {
                const textToCopy = document.getElementById("connection-url").textContent;
                navigator.clipboard.writeText(textToCopy).then(() => {
                    this.innerHTML = "<i class=\"material-icons\" style=\"font-size: 16px; vertical-align: middle; margin-right: 4px;\">check</i> Copied!";
                    setTimeout(() => {
                        this.innerHTML = "<i class=\"material-icons\" style=\"font-size: 16px; vertical-align: middle; margin-right: 4px;\">content_copy</i> Copy";
                    }, 2000);
                });
            });
            
            // Download QR
            document.getElementById("download-qr").addEventListener("click", downloadQRCode);
            
            // Donation modal
            const donationButton = document.getElementById("donation-button");
            const donationModal = document.getElementById("donation-modal");
            const closeDonationButton = document.getElementById("close-donation");
            
            if (donationButton && donationModal) {
                donationButton.addEventListener("click", () => {
                    donationModal.style.display = 'flex';
                });
                
                if (closeDonationButton) {
                    closeDonationButton.addEventListener("click", () => {
                        donationModal.style.display = 'none';
                    });
                }
                
                donationModal.addEventListener("click", (e) => {
                    if (e.target === donationModal) {
                        donationModal.style.display = 'none';
                    }
                });
            }
        }
        
        // Populate bug options
        function populateBugOptions() {
            const bugSelectors = [
                document.getElementById("vmess-bug"),
                document.getElementById('vless-bug'),
                document.getElementById("trojan-bug"),
                document.getElementById("ss-bug")
            ];
            
            bugSelectors.forEach(bugSelect => {
                if (bugSelect) {
                    bugSelect.innerHTML = '';
                    bugOptions.forEach(option => {
                        const optionElement = document.createElement("option");
                        optionElement.value = option.value;
                        optionElement.textContent = option.label;
                        bugSelect.appendChild(optionElement);
                    });
                    
                    // Add change event listener
                    bugSelect.addEventListener('change', function () {
                        const manualContainerId = this.id.replace('-bug', '-manual-bug-container');
                        const wildcardContainerId = this.id.replace('-bug', '-wildcard-container');
                        const manualBugElement = document.getElementById(this.id.replace("-bug", "-wildcard"));
                        const manualContainer = document.getElementById(manualContainerId);
                        const wildcardContainer = document.getElementById(wildcardContainerId);
                        
                        if (this.value === "manual") {
                            if (manualContainer) manualContainer.classList.add('show');
                            if (wildcardContainer) wildcardContainer.classList.remove("show");
                            if (manualBugElement) {
                                manualBugElement.checked = false;
                                manualBugElement.disabled = true;
                            }
                        } else if (this.value !== '') {
                            if (manualContainer) manualContainer.classList.remove("show");
                            if (wildcardContainer) wildcardContainer.classList.add("show");
                            if (manualBugElement) {
                                manualBugElement.disabled = false;
                            }
                        } else {
                            if (manualContainer) manualContainer.classList.remove('show');
                            if (wildcardContainer) wildcardContainer.classList.remove('show');
                            if (manualBugElement) {
                                manualBugElement.checked = false;
                                manualBugElement.disabled = false;
                            }
                        }
                    });
                }
            });
        }
        
        // Populate server domains
        function populateServerDomains() {
            const serverDomainElements = [
                document.getElementById("vmess-server-domain"),
                document.getElementById("vless-server-domain"),
                document.getElementById("trojan-server-domain"),
                document.getElementById("ss-server-domain")
            ];
            
            serverDomainElements.forEach(element => {
                if (element) {
                    element.innerHTML = '';
                    serverDomains.forEach(domain => {
                        const option = document.createElement("option");
                        option.value = domain;
                        option.textContent = domain;
                        element.appendChild(option);
                    });
                    
                    element.addEventListener("change", function () {
                        selectedServerDomain = this.value;
                    });
                }
            });
        }
        
        // Handle form submission
        function handleFormSubmit(protocol, formData) {
            let bugType = formData.get("bug") ? formData.get("bug").toString().trim() : '';
            
            if (bugType === "manual") {
                const manualBugId = `${protocol}-manual-bug`;
                const manualBugValue = document.getElementById(manualBugId).value.trim();
                if (manualBugValue) {
                    formData.set("bug", manualBugValue);
                    bugType = manualBugValue;
                } else {
                    formData.set("bug", '');
                    bugType = '';
                }
            }
            
            const isWildcardEnabled = formData.get("wildcard") === 'on';
            const serverDomain = formData.get("server-domain") || selectedServerDomain;
            let domainForWildcard = serverDomain;
            let domainWithPrefix = serverDomain;
            let fullDomain = serverDomain;
            
            if (bugType) {
                domainForWildcard = bugType;
                if (isWildcardEnabled) {
                    domainWithPrefix = bugType + '.' + serverDomain;
                    fullDomain = bugType + '.' + serverDomain;
                }
            }
            
            let result = '';
            
            if (protocol === 'vmess') {
                const securityOption = formData.get("security");
                const securityValue = securityOption === "tls" ? 443 : 80;
                const vmessConfig = {
                    'v': '2',
                    'ps': formData.get("name"),
                    'add': domainForWildcard,
                    'port': securityValue,
                    'id': formData.get('uuid'),
                    'aid': '0',
                    'net': 'ws',
                    'type': 'none',
                    'host': domainWithPrefix,
                    'path': formData.get("path"),
                    'tls': securityOption === "tls" ? "tls" : '',
                    'sni': fullDomain,
                    'scy': "zero"
                };
                result = "vmess://" + btoa(JSON.stringify(vmessConfig));
            } else if (protocol === "vless") {
                const uuid = formData.get("uuid");
                const path = encodeURIComponent(formData.get("path"));
                const security = formData.get("security");
                const name = encodeURIComponent(formData.get("name"));
                const port = security === "tls" ? 443 : 80;
                result = `vless://${uuid}@${domainForWildcard}:${port}?encryption=none&security=${security}&type=ws&host=${domainWithPrefix}&path=${path}&sni=${fullDomain}#${name}`;
            } else if (protocol === "trojan") {
                const password = formData.get("password");
                const path = encodeURIComponent(formData.get("path"));
                const security = formData.get('security');
                const name = encodeURIComponent(formData.get("name"));
                const port = security === 'tls' ? 443 : 80;
                result = `trojan://${password}@${domainForWildcard}:${port}?security=${security}&type=ws&host=${domainWithPrefix}&path=${path}&sni=${fullDomain}#${name}`;
            } else if (protocol === 'ss') {
                const password = formData.get("password");
                const name = encodeURIComponent(formData.get("name"));
                const path = encodeURIComponent(formData.get('path'));
                const security = formData.get("security");
                const port = security === "tls" ? 443 : 80;
                const encodedPassword = btoa("none:" + password);
                result = `ss://${encodedPassword}@${domainForWildcard}:${port}?encryption=none&type=ws&host=${domainWithPrefix}&path=${path}&security=${security}&sni=${fullDomain}#${name}`;
            }
            
            document.getElementById('connection-url').textContent = result;
            generateQRCode(result);
            accountCreationSection.classList.add("hidden");
            resultSection.classList.remove("hidden");
        }
        
        // Generate QR Code
        function generateQRCode(data) {
            const qrCodeContainer = document.getElementById("qrcode");
            qrCodeContainer.innerHTML = '';
            
            try {
                QRCode.toCanvas(qrCodeContainer, data, {
                    width: 200,
                    margin: 1,
                    color: {
                        dark: "#000000",
                        light: "#FFFFFF"
                    }
                }, (error) => {
                    if (error) {
                        console.error("QR Code canvas error:", error);
                        generateQRCodeFallback(data, qrCodeContainer);
                    }
                });
            } catch (error) {
                console.error("QR Code generation error:", error);
                generateQRCodeFallback(data, qrCodeContainer);
            }
        }
        
        function generateQRCodeFallback(data, qrCodeContainer) {
            try {
                QRCode.toString(data, {
                    type: "svg",
                    width: 200,
                    margin: 1,
                    color: {
                        dark: '#000000',
                        light: "#FFFFFF"
                    }
                }, (error, svg) => {
                    if (error || !svg) {
                        console.error("QR Code SVG error:", error);
                        qrCodeContainer.innerHTML = "<div class=\"text-center\" style=\"color: #f44336;\">Failed to generate QR code</div>";
                    } else {
                        qrCodeContainer.innerHTML = svg;
                    }
                });
            } catch (error) {
                console.error("QR Code SVG generation error:", error);
                qrCodeContainer.innerHTML = "<div class=\"text-center\" style=\"color: #f44336;\">Failed to generate QR code</div>";
            }
        }
        
        // Download QR Code
        function downloadQRCode() {
            const qrCodeContainer = document.getElementById("qrcode");
            const canvas = qrCodeContainer.querySelector("canvas");
            const img = qrCodeContainer.querySelector("img");
            const svg = qrCodeContainer.querySelector("svg");
            
            let qrCodeDataUrl = null;
            
            if (canvas) {
                try {
                    qrCodeDataUrl = canvas.toDataURL("image/png");
                } catch (error) {
                    console.error("Canvas to data URL error:", error);
                }
            } else if (img) {
                qrCodeDataUrl = img.src;
            } else if (svg) {
                try {
                    const svgData = new XMLSerializer().serializeToString(svg);
                    const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
                    qrCodeDataUrl = URL.createObjectURL(svgBlob);
                } catch (error) {
                    console.error("SVG to data URL error:", error);
                }
            }
            
            if (qrCodeDataUrl) {
                const downloadLink = document.createElement('a');
                downloadLink.href = qrCodeDataUrl;
                downloadLink.download = "qrcode.png";
                
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                if (qrCodeDataUrl.startsWith("blob:")) {
                    URL.revokeObjectURL(qrCodeDataUrl);
                }
            } else {
                alert("Failed to download QR code. Please try again.");
            }
        }
        
        // Display fallback proxy list
        function displayFallbackProxyList() {
            proxyList = [{
                'ip': "103.6.207.108",
                'port': "8080",
                'country': 'ID',
                'provider': "PT Pusat Media Indonesia"
            }];
            
            filteredProxyList = [...proxyList];
            renderProxyList();
        }
        
        // Process proxy data
        function processProxyData(data) {
            const proxyLines = data.split(/\r?\n/).filter(line => line.trim() !== '');
            console.log(`Found ${proxyLines.length} lines in proxy data`);
            
            if (proxyLines.length === 0) {
                noProxiesMessage.classList.remove("hidden");
                return;
            }
            
            let delimiter = ',';
            const firstLine = proxyLines[0];
            if (firstLine.includes("\t")) {
                delimiter = "\t";
            } else if (firstLine.includes('|')) {
                delimiter = '|';
            } else if (firstLine.includes(';')) {
                delimiter = ';';
            }
            
            proxyList = proxyLines.map(line => {
                const fields = line.split(delimiter);
                if (fields.length >= 2) {
                    return {
                        'ip': fields[0].trim(),
                        'port': fields[1].trim(),
                        'country': fields.length >= 3 ? fields[2].trim() : "Unknown",
                        'provider': fields.length >= 4 ? fields[3].trim() : "Unknown Provider"
                    };
                }
                return null;
            }).filter(proxy => proxy && proxy.ip && proxy.port);
            
            console.log(`Processed ${proxyList.length} valid proxies`);
            
            if (proxyList.length === 0) {
                noProxiesMessage.classList.remove("hidden");
                displayFallbackProxyList();
                return;
            }
            
            currentPage = 1;
            filteredProxyList = [...proxyList];
            renderProxyList();
        }
        
        // Render proxy list
        function renderProxyList() {
            proxyListContainer.innerHTML = '';
            
            if (filteredProxyList.length === 0) {
                noProxiesMessage.classList.remove("hidden");
                paginationContainer.innerHTML = '';
                proxyCountInfo.textContent = '';
                return;
            }
            
            noProxiesMessage.classList.add("hidden");
            
            const totalPages = Math.ceil(filteredProxyList.length / 10);
            const startIndex = (currentPage - 1) * 10;
            const endIndex = Math.min(startIndex + 10, filteredProxyList.length);
            const proxiesToDisplay = filteredProxyList.slice(startIndex, endIndex);
            
            proxiesToDisplay.forEach((proxy, index) => {
                const proxyIndex = startIndex + index;
                
                const proxyCard = document.createElement("div");
                proxyCard.className = "geo-proxy-card";
                
                const infoContainer = document.createElement("div");
                infoContainer.className = "geo-proxy-info";
                
                const providerContainer = document.createElement('div');
                providerContainer.style.display = "flex";
                providerContainer.style.alignItems = "center";
                providerContainer.style.width = "100%";
                providerContainer.style.position = "relative";
                
                const providerName = document.createElement("div");
                providerName.className = "geo-proxy-name";
                providerName.textContent = proxy.provider;
                providerContainer.appendChild(providerName);
                
                const statusIndicator = document.createElement("span");
                statusIndicator.className = "geo-status unknown";
                statusIndicator.title = "Checking...";
                statusIndicator.id = "proxy-status-" + proxyIndex;
                providerContainer.appendChild(statusIndicator);
                
                infoContainer.appendChild(providerContainer);
                
                const proxyDetails = document.createElement("div");
                proxyDetails.className = "geo-proxy-details";
                proxyDetails.textContent = `${proxy.country} | ${proxy.ip}:${proxy.port}`;
                infoContainer.appendChild(proxyDetails);
                
                const buttonContainer = document.createElement("div");
                buttonContainer.style.flexShrink = '0';
                
                const createButton = document.createElement("button");
                createButton.className = "geo-btn";
                createButton.style.whiteSpace = "nowrap";
                createButton.style.minWidth = "60px";
                createButton.setAttribute("data-index", proxyIndex);
                createButton.textContent = "Create";
                buttonContainer.appendChild(createButton);
                
                proxyCard.appendChild(infoContainer);
                proxyCard.appendChild(buttonContainer);
                proxyListContainer.appendChild(proxyCard);
                
                createButton.addEventListener("click", function () {
                    const proxyIndex = Number.parseInt(this.getAttribute('data-index'));
                    selectProxy(proxyIndex);
                    showAccountCreationSection();
                });
                
                checkProxyStatusInList(proxy, statusIndicator);
            });
            
            renderPagination(totalPages);
            proxyCountInfo.textContent = `Showing ${startIndex + 1}-${endIndex} of ${filteredProxyList.length} proxies`;
        }
        
        // Check proxy status in list
        function checkProxyStatusInList(proxy, statusIndicator) {
            const statusURL = `https://cors.checker-ip.web.id/?url=https://api-check.web.id/check?ip=${proxy.ip}:${proxy.port}`;
            
            fetch(statusURL)
                .then(response => response.json())
                .then(data => {
                    if (data.status === "ACTIVE") {
                        statusIndicator.className = "geo-status active";
                        statusIndicator.title = "Active";
                    } else {
                        statusIndicator.className = "geo-status dead";
                        statusIndicator.title = "Dead";
                    }
                })
                .catch(error => {
                    statusIndicator.className = "geo-status unknown";
                    statusIndicator.title = "Unknown";
                    console.error("Fetch error:", error);
                });
        }
        
        // Render pagination
        function renderPagination(totalPages) {
            paginationContainer.innerHTML = '';
            
            if (totalPages <= 1) {
                return;
            }
            
            const prevButton = document.createElement('button');
            prevButton.innerHTML = "<i class=\"material-icons\" style=\"font-size: 16px;\">chevron_left</i>";
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener("click", () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderProxyList();
                }
            });
            paginationContainer.appendChild(prevButton);
            
            const buttonCount = window.innerWidth < 640 ? 3 : 5;
            let startPage = Math.max(1, currentPage - Math.floor(buttonCount / 2));
            let endPage = Math.min(totalPages, startPage + buttonCount - 1);
            
            if (endPage - startPage + 1 < buttonCount) {
                startPage = Math.max(1, endPage - buttonCount + 1);
            }
            
            if (startPage > 1) {
                const firstButton = document.createElement('button');
                firstButton.textContent = '1';
                firstButton.addEventListener("click", () => {
                    currentPage = 1;
                    renderProxyList();
                });
                paginationContainer.appendChild(firstButton);
                
                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0 8px';
                    paginationContainer.appendChild(ellipsis);
                }
            }
            
            for (let page = startPage; page <= endPage; page++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = page;
                pageButton.className = page === currentPage ? 'active' : '';
                pageButton.addEventListener("click", () => {
                    currentPage = page;
                    renderProxyList();
                });
                paginationContainer.appendChild(pageButton);
            }
            
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.style.padding = '0 8px';
                    paginationContainer.appendChild(ellipsis);
                }
                
                const lastButton = document.createElement('button');
                lastButton.textContent = totalPages.toString();
                lastButton.addEventListener("click", () => {
                    currentPage = totalPages;
                    renderProxyList();
                });
                paginationContainer.appendChild(lastButton);
            }
            
            const nextButton = document.createElement('button');
            nextButton.innerHTML = "<i class=\"material-icons\" style=\"font-size: 16px;\">chevron_right</i>";
            nextButton.disabled = currentPage === totalPages;
            nextButton.addEventListener("click", () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderProxyList();
                }
            });
            paginationContainer.appendChild(nextButton);
        }
        
        // Select proxy
        async function selectProxy(proxyIndex) {
            selectedProxy = filteredProxyList[proxyIndex];
            
            document.getElementById("selected-ip").textContent = selectedProxy.ip;
            document.getElementById('selected-port').textContent = selectedProxy.port;
            document.getElementById('selected-country').textContent = selectedProxy.country;
            document.getElementById('selected-provider').textContent = selectedProxy.provider;
            
            const proxyDetails = selectedProxy.country + " - " + selectedProxy.provider;
            const proxyPath = "/Geo-Project/{ip}-{port}".replace("{ip}", selectedProxy.ip).replace("{port}", selectedProxy.port);
            
            document.getElementById('vmess-path').value = proxyPath;
            document.getElementById('vless-path').value = proxyPath;
            document.getElementById('trojan-path').value = proxyPath;
            document.getElementById('ss-path').value = proxyPath;
            
            const protocols = [
                { id: "vmess-security", nameId: "vmess-name", protocol: 'VMess' },
                { id: "vless-security", nameId: "vless-name", protocol: "VLESS" },
                { id: "trojan-security", nameId: "trojan-name", protocol: "Trojan" },
                { id: "ss-security", nameId: "ss-name", protocol: 'SS' }
            ];
            
            protocols.forEach(protocol => {
                const securityElement = document.getElementById(protocol.id);
                const nameElement = document.getElementById(protocol.nameId);
                
                const clonedElement = securityElement.cloneNode(true);
                securityElement.parentNode.replaceChild(clonedElement, securityElement);
                
                clonedElement.addEventListener("change", function () {
                    const securityType = this.value === "tls" ? "TLS" : "NTLS";
                    nameElement.value = proxyDetails + " [" + protocol.protocol + '-' + securityType + ']';
                });
            });
            
            const proxyStatusContainer = document.getElementById("proxy-status-container");
            const proxyStatusLoading = document.getElementById('proxy-status-loading');
            const proxyStatusActive = document.getElementById("proxy-status-active");
            const proxyStatusDead = document.getElementById("proxy-status-dead");
            const proxyStatusUnknown = document.getElementById("proxy-status-unknown");
            
            proxyStatusContainer.classList.remove("hidden");
            proxyStatusLoading.classList.remove('hidden');
            proxyStatusActive.classList.add("hidden");
            proxyStatusDead.classList.add("hidden");
            proxyStatusUnknown.classList.add("hidden");
            
            checkProxyStatus(selectedProxy);
        }
        
        // Check proxy status
        function checkProxyStatus(proxy) {
            const statusURL = `https://cors.checker-ip.web.id/?url=https://api-check.web.id/check?ip=${proxy.ip}:${proxy.port}`;
            const statusContainer = document.getElementById('proxy-status-container');
            const statusLoading = document.getElementById('proxy-status-loading');
            const statusActive = document.getElementById('proxy-status-active');
            const statusDead = document.getElementById('proxy-status-dead');
            const statusUnknown = document.getElementById('proxy-status-unknown');
            const latencyElement = document.getElementById('proxy-latency');
            
            statusContainer.classList.remove("hidden");
            statusLoading.classList.remove('hidden');
            statusActive.classList.add("hidden");
            statusDead.classList.add("hidden");
            statusUnknown.classList.add("hidden");
            
            fetch(statusURL)
                .then(response => response.json())
                .then(data => {
                    statusLoading.classList.add('hidden');
                    
                    if (data.status && data.status.toUpperCase() === "ACTIVE") {
                        statusActive.classList.remove('hidden');
                        latencyElement.textContent = data.delay || '-';
                    } else {
                        statusDead.classList.remove('hidden');
                        latencyElement.textContent = '-';
                    }
                })
                .catch(error => {
                    statusLoading.classList.add('hidden');
                    statusUnknown.classList.remove('hidden');
                    latencyElement.textContent = '-';
                    console.error("Fetch error:", error);
                });
        }
        
        // Show sections
        function showProxyListSection() {
            proxyListSection.classList.remove("hidden");
            accountCreationSection.classList.add("hidden");
            resultSection.classList.add('hidden');
        }
        
        function showAccountCreationSection() {
            proxyListSection.classList.add("hidden");
            accountCreationSection.classList.remove("hidden");
            resultSection.classList.add('hidden');
        }
        
        // Load proxy list
        function loadProxyList(url) {
            loadingIndicator.classList.remove('hidden');
            proxyListContainer.innerHTML = '';
            noProxiesMessage.classList.add("hidden");
            
            const proxyFetchers = [
                async () => {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error("Direct fetch failed");
                    }
                    return await response.text();
                },
                async () => {
                    const proxyUrl = `https://cors.checker-ip.web.id/?url=${url}`;
                    const response = await fetch(proxyUrl);
                    if (!response.ok) {
                        throw new Error("CORS proxy failed");
                    }
                    return await response.text();
                }
            ];
            
            (async function fetchDataFromProxies(proxyIndex = 0) {
                if (proxyIndex >= proxyFetchers.length) {
                    console.error("All proxies failed");
                    loadingIndicator.classList.add("hidden");
                    noProxiesMessage.classList.remove("hidden");
                    displayFallbackProxyList();
                    return;
                }
                
                try {
                    const data = await proxyFetchers[proxyIndex]();
                    console.log("Fetched data:", data.substring(0, 200) + '...');
                    processProxyData(data);
                    loadingIndicator.classList.add('hidden');
                } catch (error) {
                    console.error("Proxy " + url + " failed:", error);
                    fetchDataFromProxies(proxyIndex + 1);
                }
            })();
        }
        
        // Generate UUID
        function generateUUID(inputElementId) {
            const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, char => {
                const randomValue = Math.random() * 0x10 | 0;
                const value = char === 'x' ? randomValue : randomValue & 0x3 | 0x8;
                return value.toString(16);
            });
            document.getElementById(inputElementId).value = uuid;
        }
        
        // Generate password
        function generatePassword(inputElementId) {
            generateUUID(inputElementId);
        }
    </script>
</body>
</html>
